<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>STORE</title>
    <script src="../static/js/jquery.min.js" charset="utf-8"></script>
    <script src="../static/js/bootstrap.min.js" charset="utf-8"></script>
    <script src="../static/vue/vue.min.js"></script>
    <script src="../static/vue/vue-tables-2.min.js"></script>


    <link rel="stylesheet" href="../static/css/bootstrap.min.css">

    <style media="screen">
      .margin-top-5{margin-top: 5px;}
    </style>

  </head>
  <body>
    <div class="container-fluid" id="master-page">

      <!-- tab head -->
      <ul class="nav nav-tabs">
        <li class="active"><a href="#Pool" data-toggle="tab" @click="getPoolList()"><h2>Pool</h2></a></li>
        <li><a href="#Pending" data-toggle="tab" @click="getPendingList()"><h2>Pending</h2></a></li>
        <li><a href="#Archive" data-toggle="tab" ><h2>Archive</h2></a></li>
        <li><a href="#Closed" data-toggle="tab" @click="getClosedList()"><h2>Closed</h2></a></li>
        <h1 class="pull-right">{{store.name}}</h1>
      </ul>
      <div class="tab-content">
        <div class="tab-pane fade margin-top-5 in active" id="Pool">
          <v-client-table :columns="columns.pool" :data="lines.pool" :options="options">
          </v-client-table>
        </div>
        <div class="tab-pane fade margin-top-5" id="Pending">
        </div>
        <div class="tab-pane fade margin-top-5" id="Archive">
        </div>
        <div class="tab-pane fade margin-top-5" id="Closed">
        </div>
      </div>


      <!-- modal -->
      <div class="modal fade" tabindex="-1" role="dialog" id="Add_Drug_Modal">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
              <h4 class="modal-title">Add Drug</h4>
            </div>
            <div class="modal-body">
              <div class="row">
                <div class="col-md-6 margin-top-5">
                  <input typ="teext" class="form-control" v-model="new_drug.name" placeholder="drug name">
                </div>
                <div class="col-md-6 margin-top-5">
                  <input type="number" class="form-control" v-model="new_drug.qty" placeholder="drug quantity">
                </div>
                <div class="col-md-6 margin-top-5">
                  <input type="text" class="form-control" v-model="new_drug.remark" placeholder="remark">
                </div>
                <div class="col-md-6 margin-top-5">
                  <input type="text" class="form-control" v-model="new_drug.usage" placeholder="drug usage">
                </div>
              </div>
            </div>
            <div class="modal-footer margin-top-5">
              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
              <button type="button" class="btn btn-primary" @click="" :disabled="new_drug.name==''||new_drug.qty<1">Finish</button>
            </div>
          </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
      </div><!-- /.modal -->
    </div>

  </body>

  <!-- vue -->
  <script>
  Vue.use(VueTables.ClientTable);
  var app = new Vue({
  	el: '#master-page',
  	data: function(){
  		return {
  			store: {
          name: "吉星大药房",
          sid: "10086",
          type: 1,
          site: "邯郸路220号",
        },
        new_deal:{
          prescription_ID: "",
          medicine_name: "",
          amount: 0,
          ts: 0,
          site: "邯郸路220号",
          price: 0.00,
        },
        columns:{
          pool:["Type", "Presciption_id", "Hospital_id","Patient_id","Ts","Data","Ishandled","Policy",],
          pending:["Type", "Presciption_id", "Hospital_id","Patient_id","Ts","Data","Ishandled","Policy",],
          archive:["Type", "Presciption_id", "Hospital_id","Patient_id","Ts","Data","Ishandled","Policy",],
          closed:["Type", "Presciption_id", "Hospital_id","Patient_id","Ts","Data","Ishandled","Policy",],
        },
        lines:{
          pool:[],
          pending:[],
          archive:[],
          closed:[],
        },
        options: {
  				headings: {
  					xxx: "xxx", //
  				},
  				sortable: ["xxx"],
  				filterable: ["xxx"],
  			},
        pool_list:[],
        drug_list:[],
        prescription_list:[],
        pending_list:[],
        closed_list:[],
        new_archive:{
          prescription_ID: "",
          medicine_name: "",
          amount: 0,
          ts: 0,
          site: "邯郸路220号",
          price: 0.00,
        },
        new_drug:{
          name:"",
          chemistry_name:"",
          qty: 0,
          remark: "",
          usage: "",
          amount: "",
        },
  		}
  	},
  	methods: {
  		func: function(){
  			var _this = this;
  			var postData = {};
  			postData["receiver"] = 999;
  			console.log(postData)
  			$.post("...",postData,function(data,status){
  				if (status=="success") {
  					console.log(data)
  				}else{alert("Error!Code: "+status);}
  			});
  			return;
  		},
      getPoolList: function(){
        var _this = this;

  			$.post("http://"+window.location.host + "/",{},function(data,status){
  				if (status=="success") {
            // ###################
            console.log(data);
            var objs = eval(data)
            // console.log(objs);

            // $.each();
            $.each(objs, function(k,v){
                var tmp = {}
                tmp["Patient_id"] = v["Patient_id"]
                tmp["presciption_id"] = v.Data["presciption_id"]
                tmp["medicine_name"] = v.Data["medicine_name"]
                tmp["amount"] = v.Data["amount"]
                tmp["ts"] = v.Data["ts"]
                tmp["site"] = v.Data["site"]
                tmp["price"] = v.Data["price"]
                tmp["Ishandled"] = v.Ishandled

                _this.lines.pool.push(tmp)
            });
            // return
            // _this.lines.pool = objs
  					// console.log(data)
  				}else{alert("Error!Code: "+status);}
  			});

        return 0
  		},
      getPendingList: function(){
        return 0
  		},
      getClosedList: function(){
        return 0
  		},
      getDrugList: function(){
        return 0
  		},
  	},
  	computed: {
  	},
  	created(){
  		// this.fetch_person_info();
  		// this.fetch_history_record();
  	}
  });
  </script>
</html>
